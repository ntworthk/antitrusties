<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoustonKemp 2025 Predictions</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.10.17/interact.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #34495e;
            --correct-color: #27ae60;
            --incorrect-color: #c0392b;
            --pending-color: #7f8c8d;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f6fa;
            color: var(--primary-color);
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .section-title {
            margin: 0 0 1rem 0;
            color: var(--secondary-color);
            border-bottom: 2px solid #eee;
            padding-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .add-prediction {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .add-prediction input {
            flex-grow: 1;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .add-prediction button {
            padding: 0.5rem 1rem;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .add-prediction button:hover {
            background: var(--secondary-color);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
        }

        .prediction-card {
            background: white;
            padding: 1rem;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: move;
            user-select: none;
            touch-action: none;
            position: relative;
            margin-bottom: 1rem;
            display: flex;
            align-items: start;
            gap: 1rem;
        }

        .status-box {
            width: 24px;
            height: 24px;
            border: 2px solid var(--pending-color);
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .status-box.correct {
            border-color: var(--correct-color);
            background-color: var(--correct-color);
            color: white;
        }

        .status-box.incorrect {
            border-color: var(--incorrect-color);
            background-color: var(--incorrect-color);
            color: white;
        }

        .prediction-content {
            flex-grow: 1;
        }

        .prediction-text {
            margin-bottom: 0.5rem;
        }

        .notes-section {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--secondary-color);
        }

        .notes-input {
            width: 100%;
            margin-top: 0.5rem;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .dragging {
            opacity: 0.8;
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>HoustonKemp 2025 Predictions</h1>
        </header>

        <section id="available-picks" class="section">
            <h2 class="section-title">Available Picks</h2>
            <div class="add-prediction">
                <input type="text" id="new-prediction" placeholder="Enter a new prediction...">
                <button onclick="addPrediction()">Add</button>
            </div>
            <div class="predictions-container">
                <!-- Predictions will be added here -->
            </div>
        </section>

        <section class="section">
            <h2 class="section-title">Assigned Predictions</h2>
            <div class="grid">
                <div id="person1" class="section">
                    <h3 class="section-title">Person 1</h3>
                    <div class="predictions-container"></div>
                </div>
                <div id="person2" class="section">
                    <h3 class="section-title">Person 2</h3>
                    <div class="predictions-container"></div>
                </div>
                <div id="person3" class="section">
                    <h3 class="section-title">Person 3</h3>
                    <div class="predictions-container"></div>
                </div>
                <div id="person4" class="section">
                    <h3 class="section-title">Person 4</h3>
                    <div class="predictions-container"></div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Initialize data from localStorage or use defaults
        let predictions = JSON.parse(localStorage.getItem('predictions')) || [
            {
                id: 1,
                text: "ACCC will block at least one merger in the energy sector",
                status: "pending",
                notes: "",
                container: "available-picks"
            },
            {
                id: 2,
                text: "Telstra will attempt to acquire a media company",
                status: "pending",
                notes: "",
                container: "available-picks"
            }
        ];

        function saveToLocalStorage() {
            localStorage.setItem('predictions', JSON.stringify(predictions));
        }

        function createPredictionCard(prediction) {
            const card = document.createElement('div');
            card.className = 'prediction-card';
            card.setAttribute('data-id', prediction.id);
            
            const statusIcon = prediction.status === 'correct' ? 'fa-check' :
                             prediction.status === 'incorrect' ? 'fa-times' : '';
            
            card.innerHTML = `
                <div class="status-box ${prediction.status}" onclick="cycleStatus(${prediction.id})">
                    ${statusIcon ? `<i class="fas ${statusIcon}"></i>` : ''}
                </div>
                <div class="prediction-content">
                    <div class="prediction-text">${prediction.text}</div>
                    <div class="notes-section">
                        <input type="text" class="notes-input" placeholder="Add notes/links here..." 
                               value="${prediction.notes}" 
                               onchange="updateNotes(${prediction.id}, this.value)">
                    </div>
                </div>
            `;
            
            return card;
        }

        function cycleStatus(id) {
            const prediction = predictions.find(p => p.id === id);
            if (prediction) {
                // Cycle through states: pending -> correct -> incorrect -> pending
                prediction.status = prediction.status === 'pending' ? 'correct' :
                                  prediction.status === 'correct' ? 'incorrect' : 'pending';
                
                const card = document.querySelector(`[data-id="${id}"]`);
                const statusBox = card.querySelector('.status-box');
                statusBox.className = `status-box ${prediction.status}`;
                
                // Update icon
                statusBox.innerHTML = prediction.status === 'correct' ? '<i class="fas fa-check"></i>' :
                                    prediction.status === 'incorrect' ? '<i class="fas fa-times"></i>' : '';
                
                saveToLocalStorage();
            }
        }

        function updateNotes(id, notes) {
            const prediction = predictions.find(p => p.id === id);
            if (prediction) {
                prediction.notes = notes;
                saveToLocalStorage();
            }
        }

        function addPrediction() {
            const input = document.getElementById('new-prediction');
            const text = input.value.trim();
            
            if (text) {
                const newPrediction = {
                    id: Date.now(),
                    text: text,
                    status: 'pending',
                    notes: '',
                    container: 'available-picks'
                };
                
                predictions.push(newPrediction);
                const availableContainer = document.querySelector('#available-picks .predictions-container');
                availableContainer.appendChild(createPredictionCard(newPrediction));
                
                input.value = '';
                saveToLocalStorage();
            }
        }

        // Initialize drag and drop
        interact('.prediction-card').draggable({
            inertia: true,
            modifiers: [
                interact.modifiers.restrictRect({
                    restriction: 'parent',
                    endOnly: true
                })
            ],
            autoScroll: true,
            listeners: {
                start(event) {
                    event.target.classList.add('dragging');
                },
                move(event) {
                    const target = event.target;
                    const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                },
                end(event) {
                    event.target.classList.remove('dragging');
                }
            }
        });

        interact('.predictions-container').dropzone({
            accept: '.prediction-card',
            overlap: 0.75,
            ondropactivate: function (event) {
                event.target.classList.add('drop-active');
            },
            ondragenter: function (event) {
                event.target.classList.add('drop-target');
            },
            ondragleave: function (event) {
                event.target.classList.remove('drop-target');
            },
            ondrop: function (event) {
                const dragged = event.relatedTarget;
                const dropzone = event.target;
                const predictionId = parseInt(dragged.getAttribute('data-id'));
                const prediction = predictions.find(p => p.id === predictionId);
                
                if (prediction) {
                    prediction.container = dropzone.parentElement.id;
                    saveToLocalStorage();
                }
                
                dropzone.appendChild(dragged);
                dragged.style.transform = 'translate(0px, 0px)';
                dragged.setAttribute('data-x', 0);
                dragged.setAttribute('data-y', 0);
            },
            ondropdeactivate: function (event) {
                event.target.classList.remove('drop-active');
                event.target.classList.remove('drop-target');
            }
        });

        // Initialize the page with stored predictions
        window.onload = function() {
            predictions.forEach(prediction => {
                const container = document.querySelector(`#${prediction.container} .predictions-container`);
                if (container) {
                    container.appendChild(createPredictionCard(prediction));
                }
            });

            // Add enter key support for new predictions
            document.getElementById('new-prediction').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addPrediction();
                }
            });
        };
    </script>
</body>
</html>
